{% extends "base.html" %}
{% block content %}

<h3>Generate GST Invoice</h3>

<form method="POST">

  <!-- CUSTOMER DETAILS -->
  <div class="row g-3 mb-3">
    <div class="col-md-4">
      <label>Customer Name</label>
      <input name="customer_name" class="form-control" required>
    </div>

    <div class="col-md-4">
      <label>Customer GSTIN</label>
      <input name="customer_gstin" class="form-control">
    </div>

    <div class="col-md-4">
      <label>Discount</label>
      <input name="discount" type="number" step="0.01" value="0" class="form-control">
      <small class="text-muted">≤100 = %, >100 = ₹</small>
    </div>
  </div>
    <div class="col-md-4">
  <label>Invoice Date</label>
  <input type="date"
         name="invoice_date"
         value="{{ today }}"
         class="form-control"
         required>
</div>


  <!-- GST CONTROLS -->
  <div class="row g-3 mb-4">
    <div class="col-md-3">
      <div class="form-check">
        <input class="form-check-input" type="checkbox" name="enable_cgst" checked>
        <label class="form-check-label">Enable CGST</label>
      </div>
      <input name="cgst_percent" type="number" step="0.01" value="9" class="form-control mt-1">
    </div>

    <div class="col-md-3">
      <div class="form-check">
        <input class="form-check-input" type="checkbox" name="enable_sgst" checked>
        <label class="form-check-label">Enable SGST</label>
      </div>
      <input name="sgst_percent" type="number" step="0.01" value="9" class="form-control mt-1">
    </div>
  </div>

  <hr>

  <!-- PRODUCTS -->
  <h5>Add Products</h5>

  {% for p in products %}
  <div class="row align-items-center mb-2">

    <!-- PRODUCT DESCRIPTION -->
    <div class="col-md-6">
      <strong>
        {{ p[1] }}
        {% if p[2] %} - {{ p[2] }}{% endif %}
        {% if p[3] %} - {{ p[3] }}{% endif %}
        {% if p[5] %} - {{ p[5] }}
        {% elif p[4] %} - {{ p[4] }}
        {% endif %}
      </strong>
      <br>
      <small class="text-muted">Stock: {{ p[6] }}</small>
    </div>

    <!-- PRICE -->
    <div class="col-md-2">
      ₹ {{ "%.2f"|format(p[8]) }}
    </div>

    <!-- QUANTITY -->
    <div class="col-md-2">
      <input type="number"
             name="qty_{{ p[0] }}"
             min="0"
             max="{{ p[6] }}"
             class="form-control">
    </div>

  </div>
  {% endfor %}

  <button class="btn btn-primary mt-4">
    Generate Invoice
  </button>

</form>

{% endblock %}
