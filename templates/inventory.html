{% extends "base.html" %}
{% block content %}

<h3 class="mb-3">Inventory</h3>

<a href="/export" class="btn btn-success mb-3">Export to Excel</a>

<div class="table-responsive">
<table class="table table-bordered table-hover align-middle">
    <thead class="table-dark">
        <tr>
            <th>ID</th>
            <th>Category</th>
            <th>Size</th>
            <th>Type</th>
            <th>Pattern / Variant</th>
            <th>Quantity</th>
            <th>Threshold</th>
            <th>Price (₹)</th>
            <th>Last Updated</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for p in products %}
        <tr class="{% if p[6] <= p[7] %}table-danger{% endif %}">
            <td>{{ p[0] }}</td>
            <td>{{ p[1] }}</td>
            <td>{{ p[2] or "-" }}</td>
            <td>{{ p[3] or "-" }}</td>
            <td>{{ p[5] or p[4] or "-" }}</td>
            <td>{{ p[6] }}</td>
            <td>{{ p[7] }}</td>
            <td>₹ {{ "%.2f"|format(p[8]) }}</td>
            <td>{{ p[9] }}</td>
            <td>
                <a href="/edit/{{ p[0] }}" class="btn btn-sm btn-warning">Edit</a>

                {% if session.get('role') == 'admin' %}
                <form action="/delete-product/{{ p[0] }}" method="POST" style="display:inline;"
                      onsubmit="return confirm('Are you sure you want to delete this product?');">
                    <button class="btn btn-sm btn-danger">Delete</button>
                </form>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
</div>

{% endblock %}
